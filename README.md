# HiFi-Somatic-Nextflow
HiFi-Somatic-Nextflow was migrated from the Pacbio' HiFi-Somatic-WDL(https://github.com/PacificBiosciences/HiFi-somatic-WDL) and adopted nextflow-DSL2 to rewrite the pipeline scripts, which make it to be more flexible and customizable. To run HiFi-Somatic-Nextflow, user need to do  
1) Clone the pipeline' main script- HiFi_Somatic_analysis.nf, configuration file -nextflow.config, and the function modules' script package- module folder.
2) Get singularity containers (annotsv_3.3.6.sif,chord.sif,deepsomatic_1.6.1.sif, mosdepth_0.3.4.sif, purple.sif, severus.sif, bcftools_1.17.sif, clair3.sif, ensembl-vep.sif, pb-cpg-tools.sif, samtools_1.17.sif, somatic_r_tools.sif, bedtools_2.31.0.sif, cnvkit_0.9.10.sif , hiphase.sif, pbmm2_1.12.0.sif, seqkit_2.5.1.sif, svpack.sif) from docker image hubs.  HiFi-Somatic-WDL (Section-Tool versions) provide a table for tools used in the workflow. 
3) Created a HiFi_Somatic_Config folder and  download HiFi-Somatic related resources and references (https://github.com/PacificBiosciences/HiFi-somatic-WDL/blob/main/docs/step-by-step.md#download-the-resources-and-references) here.
4) Prepare your HiFi unaligned bam samplesheet. Each row corresponds to one hifi unaligned bam and have three TAB separated columns as Pateint_ID, Normal/Tumor, and location of hifi reads' bam respectively.   
5) Configure nextflow.config for configuration of singularity container,  HiFi_Somatic_Config, and the samplesheet.  For customized running, you can furtherly configure the switch parameter to Y/N.
6) Submit your job to HPC cluster. E.g  #bsub -P Somatic_singularity -q heavy_io -M 20000 -e err%J.err -o out%J.out -J Somatic_singularity "module load nextflow/21.10.5 && nextflow run ./HiFi_Somatic_analysis.nf -profile singularity -with-report HiFi_Somatic_Nextflow_Summit_Run_Report.html -with-dag HiFi_Somatic_Nextflow_Summit_Run_Flowchart.png"#
